"use strict";(self["webpackChunkmedicine"]=self["webpackChunkmedicine"]||[]).push([[588],{3588:function(e,t,i){i.r(t),i.d(t,{default:function(){return k}});var l=i(3396),a=i(7139);const r={key:0,class:"Form chọn khu xưởng"},n={key:1,class:"Form thao tac don xin bao phe"},o={key:0,style:{"text-align":"left"}},s={class:"title"},c={class:"Form thao tác nhập mã hiệu thuốc và add tạm thời"},u={key:1,class:"Form hien thi thong tin thuoc sau khi nhan nut Add"},d={style:{"text-align":"left"}},m={style:{color:"#66CDAA",cursor:"pointer","font-size":"small"}},h={key:2,class:"Form chọn lưu trình ký"},p={style:{"text-align":"left"}},g={key:3,class:"Form lich su ky duyet"},f={style:{"text-align":"left"}},_={class:"Form thao tac ky duyet",style:{"margin-top":"40px"}},S={class:"Dialog"},w={class:"dialog-footer"};function D(e,t,i,D,E,y){const N=(0,l.up)("el-option"),F=(0,l.up)("el-select"),I=(0,l.up)("el-form-item"),b=(0,l.up)("el-col"),k=(0,l.up)("el-row"),M=(0,l.up)("Right"),W=(0,l.up)("el-icon"),C=(0,l.up)("el-button"),$=(0,l.up)("Back"),A=(0,l.up)("Printer"),T=(0,l.up)("el-text"),U=(0,l.up)("el-divider"),V=(0,l.up)("el-input"),x=(0,l.up)("el-date-picker"),z=(0,l.up)("Plus"),O=(0,l.up)("el-table-column"),R=(0,l.up)("Delete"),j=(0,l.up)("el-table"),Z=(0,l.up)("el-step"),v=(0,l.up)("el-tooltip"),L=(0,l.up)("el-steps"),G=(0,l.up)("EditPen"),P=(0,l.up)("Failed"),q=(0,l.up)("el-radio"),Y=(0,l.up)("el-radio-group"),Q=(0,l.up)("el-form"),H=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[E.isShowSelectFactoryZone?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(k,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:8},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Khu xưởng/Phòng y tế")},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{modelValue:E.frm.FactoryZone,"onUpdate:modelValue":t[0]||(t[0]=e=>E.frm.FactoryZone=e),placeholder:e.$t("Vui lòng chọn khu xưởng/Phòng y tế"),clearable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(E.FactoryZoneLs,(e=>((0,l.wg)(),(0,l.j4)(N,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.Wm)(k,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:8},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{size:"large",type:"success",onClick:t[1]||(t[1]=e=>y.NextFromSelectFactory()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(M)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Tiếp theo")),1)])),_:1})])),_:1})])),_:1})])):((0,l.wg)(),(0,l.iD)("div",n,[this.frm.scrapDocNum?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(C,{style:{border:"none"},onClick:t[2]||(t[2]=e=>y.ResetSome())},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)($)])),_:1}),(0,l.Uk)("   "+(0,a.zw)(e.$t("Trở lại")),1)])),_:1})])),(0,l._)("div",null,[(0,l.Wm)(C,{style:{float:"right"},onClick:t[3]||(t[3]=e=>y.Print())},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(A)])),_:1}),(0,l.Uk)("   "+(0,a.zw)(e.$t("")),1)])),_:1})]),(0,l._)("h3",s,[(0,l.Wm)(T,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Đơn xin báo phế")),1)])),_:1}),(0,l.Uk)(" :")]),(0,l.Wm)(U),(0,l._)("div",c,[(0,l.Wm)(k,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Đầu đơn xin báo phế"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.frm.scrapDocNum,"onUpdate:modelValue":t[4]||(t[4]=e=>E.frm.scrapDocNum=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(b,{md:10},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Khu xưởng/Phòng y tế"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.frm.FactoryZone,"onUpdate:modelValue":t[5]||(t[5]=e=>E.frm.FactoryZone=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(k,{key:0,gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Số hiệu"),rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.curMedicineID,"onUpdate:modelValue":t[6]||(t[6]=e=>E.curMedicineID=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(b,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Tên hàng"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.curMedicineName,"onUpdate:modelValue":t[7]||(t[7]=e=>E.curMedicineName=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(b,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Quy cách"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.curMedicineObjUnit,"onUpdate:modelValue":t[8]||(t[8]=e=>E.curMedicineObjUnit=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})):(0,l.kq)("",!0),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(k,{key:1,gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Hạn sử dụng"),rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{onBlur:t[9]||(t[9]=e=>y.OnchangeExpiredDate()),modelValue:E.curExpiredDate,"onUpdate:modelValue":t[10]||(t[10]=e=>E.curExpiredDate=e),clearable:"",type:"date",format:"YYYY/MM/DD","value-format":"YYYY/MM/DD",placeholder:e.$t("Chọn hạn sử dụng")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(b,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Số lượng báo phế"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.curQtyInStockNow,"onUpdate:modelValue":t[11]||(t[11]=e=>E.curQtyInStockNow=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})):(0,l.kq)("",!0),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(k,{key:2,gutter:24},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:11}),(0,l.Wm)(b,{md:2},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{size:"large",type:"success",onClick:t[12]||(t[12]=e=>y.AddTempMedicineExport()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(z)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Thêm")),1)])),_:1})])),_:1}),(0,l.Wm)(b,{md:11})])),_:1})):(0,l.kq)("",!0)]),null!=this.frm.medicineExportLs&&this.frm.medicineExportLs.length>0?((0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("h3",d,[(0,l.Wm)(T,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Chi tiết các sản phẩm xin:")),1)])),_:1})]),(0,l.Wm)(U),(0,l.Wm)(j,{data:this.frm.medicineExportLs,style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{type:"index",label:e.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,l.Wm)(O,{prop:"F_MEDICINE_ID",label:e.$t("Số hiệu")},null,8,["label"]),(0,l.Wm)(O,{prop:"F_MEDICINE_NAME",label:e.$t("Tên hàng")},null,8,["label"]),(0,l.Wm)(O,{prop:"F_MEDICINE_OBJ_UNIT",label:e.$t("Quy cách")},null,8,["label"]),(0,l.Wm)(O,{prop:"F_MEDICINE_EXPIRED_DATE",label:e.$t("Hạn sử dụng")},null,8,["label"]),(0,l.Wm)(O,{prop:"F_QTY_SCRAP",label:e.$t("Số lượng báo phế")},null,8,["label"]),(0,l.Wm)(O,{prop:"F_REQUEST_DATE",label:e.$t("Ngày yêu cầu")},null,8,["label"]),(0,l.Wm)(O,{label:e.$t("Ngày xuất kho báo phế thực tế")},{default:(0,l.w5)((e=>[(0,l.Uk)((0,a.zw)(e.row.F_REQUEST_DATE==e.row.F_SYSDATE?"":e.row.F_SYSDATE),1)])),_:1},8,["label"]),(0,l.Wm)(O,{label:e.$t("Mã đầu đơn xác nhận báo phế")},{default:(0,l.w5)((e=>[(0,l.Wm)(C,{size:"small",link:!0,onClick:t=>y.GotoDetailDocNumPage(e.row.F_CSCRAP_DOC_NUM)},{default:(0,l.w5)((()=>[(0,l._)("span",m,(0,a.zw)(e.row.F_CSCRAP_DOC_NUM),1)])),_:2},1032,["onClick"])])),_:1},8,["label"]),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(O,{key:0,label:e.$t("Hành động")},{default:(0,l.w5)((t=>[(0,l.Wm)(C,{size:"small",type:"danger",plain:"",onClick:e=>y.DeleteTempMedicineExport(t.row.F_MEDICINE_ID,t.row.F_MEDICINE_EXPIRED_DATE)},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(R)])),_:1}),(0,l.Uk)("   "+(0,a.zw)(e.$t("Xóa")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])):(0,l.kq)("",!0)])),_:1},8,["data"])])):(0,l.kq)("",!0),null!=this.frm.signStationLs&&this.frm.signStationLs.length>0?((0,l.wg)(),(0,l.iD)("div",h,[(0,l._)("h3",p,[(0,l.Wm)(T,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Lưu trình ký:")),1)])),_:1})]),(0,l.Wm)(U),(0,l.Wm)(L,{style:{"max-width":"100%","margin-top":"30px"},active:E.activeStepSign,"finish-status":"success","align-center":""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(this.frm.signStationLs,(e=>((0,l.wg)(),(0,l.j4)(v,{key:e,class:"box-item",content:e.F_SIGN_STATION+"/"+e.F_SIGN_NAME+"/"+e.F_SIGN_EMP,placement:"top-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{title:e.F_SIGN_STATION,description:e.F_SIGN_NAME},null,8,["title","description"])])),_:2},1032,["content"])))),128))])),_:1},8,["active"])])):(0,l.kq)("",!0),null!=this.RSignDetail&&this.RSignDetail.length>0?((0,l.wg)(),(0,l.iD)("div",g,[(0,l._)("h3",f,[(0,l.Wm)(T,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Lịch sử ký duyệt:")),1)])),_:1})]),(0,l.Wm)(U),(0,l.Wm)(j,{data:this.RSignDetail,style:{width:"100%",height:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{type:"index",label:e.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,l.Wm)(O,{prop:"STATION_NAME",label:e.$t("Tên Trạm ký")},null,8,["label"]),(0,l.Wm)(O,{prop:"SIGN_STATUS",label:e.$t("Trạng thái")},null,8,["label"]),(0,l.Wm)(O,{prop:"SIGN_EMP",label:e.$t("Mã thẻ người ký")},null,8,["label"]),(0,l.Wm)(O,{prop:"SIGN_NAME",label:e.$t("Họ tên người ký")},null,8,["label"]),(0,l.Wm)(O,{prop:"SIGN_MAIL",label:e.$t("Email người ký")},null,8,["label"]),(0,l.Wm)(O,{prop:"SIGN_NOTES",label:e.$t("Ý kiến")},null,8,["label"]),(0,l.Wm)(O,{prop:"CREATE_DATE",label:e.$t("Ngày ký")},null,8,["label"])])),_:1},8,["data"])])):(0,l.kq)("",!0),(0,l._)("div",_,[(0,l.Wm)(k,{gutter:24},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{md:10}),(0,l.Wm)(b,{md:8},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{size:"large",type:"success",onClick:t[13]||(t[13]=e=>y.DoSign()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(G)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Ký duyệt")),1)])),_:1}),(0,l.Uk)("   "),(0,l.Wm)(C,{size:"large",type:"danger",onClick:t[14]||(t[14]=e=>y.DoReject()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(P)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Từ chối")),1)])),_:1})])),_:1}),(0,l.Wm)(b,{md:10})])),_:1})])])),(0,l._)("div",S,[(0,l.Wm)(H,{class:"Form xác nhận ký duyệt",modelValue:E.isShowSignDialog,"onUpdate:modelValue":t[19]||(t[19]=e=>E.isShowSignDialog=e),title:e.$t("Xác nhận ")+" "+(1==E.frm.isReject?e.$t("Từ chối"):e.$t("Ký duyệt")),width:"500"},{footer:(0,l.w5)((()=>[(0,l._)("div",w,[(0,l.Wm)(C,{plain:"",type:"primary",onClick:t[17]||(t[17]=e=>y.DoSignApplicationForScrap())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Gửi đi")),1)])),_:1}),(0,l.Wm)(C,{plain:"",type:"warning",onClick:t[18]||(t[18]=e=>E.isShowSignDialog=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Hủy bỏ")),1)])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:e.$t("Ý kiến")},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:E.frm.remark,"onUpdate:modelValue":t[15]||(t[15]=e=>E.frm.remark=e),placeholder:e.$t("Nhập vào ý kiến của bạn"),type:"textarea"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),E.frm.isReject?((0,l.wg)(),(0,l.j4)(I,{key:0,label:e.$t("Trả về trạm:")},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,{modelValue:E.frm.RejectStation,"onUpdate:modelValue":t[16]||(t[16]=e=>E.frm.RejectStation=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"FirstStation"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Người làm đơn")),1)])),_:1}),(0,l.Wm)(q,{label:"BeforeStation"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Trạm ký trước")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["modelValue","title"])])],64)}i(560);var E=i(6e3),y=i(7178),N=i(1822),F={name:"NewApplicationForScrap",data(){return{activeStepSign:0,isFirstStationNow:!1,isShowSignDialog:!1,FactoryZoneLs:[],isShowSelectFactoryZone:!0,RSignDetail:[],frm:{scrapDocNum:"",medicineExportLs:[],FactoryZone:"",signStationLs:[],remark:"",RejectStation:"BeforeStation",isReject:!1},curMedicineID:"",curMedicineName:"",curMedicineNameVi:"",curMedicineNameEn:"",curMedicineObjUnit:"",curMedicineObjUnitVi:"",curMedicineObjUnitEn:"",curQtyInStockNow:0,curExpiredDate:""}},methods:{Print(){const e=this.$router.resolve({name:"PrintAppForScrap",hash:"",query:{scrapDocNum:this.frm.scrapDocNum}});window.open(e.href,"",`height=${window.innerHeight},width=${window.innerWidth}`)},CaculateStepSign(){if(this.activeStepSign=0,null!=this.RSignDetail&&this.RSignDetail.length>0){let e=this.RSignDetail.filter((e=>{if("FinalPoint"==e.F_ROW_ID)return!0}));if(e.length>0){for(let t=0;t<this.frm.signStationLs.length;t++)if(this.frm.signStationLs[t].F_SIGN_STATION==e[0].STATION_NAME)return void(this.activeStepSign=t)}else this.activeStepSign=this.frm.signStationLs.length}else null!=this.frm.signStationLs&&this.frm.signStationLs.length>0&&this.frm.signStationLs.length>=2&&(this.activeStepSign=0)},GotoDetailDocNumPage(e){this.$router.push({path:"/AppForScrapView",hash:"",query:{CscrapDocNum:e}})},OnchangeExpiredDate(){this.curMedicineID?.trim()?this.frm.FactoryZone?.trim()?this.curExpiredDate?.trim()?N.Z.CheckMedicineIDForApplicationForScrap({MedicineID:this.curMedicineID?.trim(),FactoryZone:this.frm.FactoryZone,ExpiredDate:this.curExpiredDate},(e=>{if("error"==e.data.status)y.z8.error(e?.data?.message),this.ResetSomeCurInfor();else if(e?.data?.data){let t=e?.data?.data;this.curMedicineNameVi=t.MedicineNameVi,this.curMedicineNameEn=t.MedicineNameEn,this.curMedicineName=this.curMedicineNameVi+"/"+this.curMedicineNameEn,this.curMedicineObjUnitVi=t.MedicineObjUnitVi,this.curMedicineObjUnitEn=t.MedicineObjUnitEn,this.curMedicineObjUnit=this.curMedicineObjUnitVi+"/"+this.curMedicineObjUnitEn,this.curQtyInStockNow=t.QtyInStockNow}}),(e=>{y.z8.error(e.message),this.ResetSomeCurInfor()})):y.z8.error(this.$t("Vui lòng nhập ngày hết hạn")):y.z8.error(this.$t("Chưa có thông tin khu xưởng/phòng y tế")):y.z8.error(this.$t("Vui lòng chọn số hiệu"))},GetHistorySignOfApplicationForScrap(){this.RSignDetail=[],N.Z.GetHistorySignOfApplicationForScrap({scrapDocNum:this.frm.scrapDocNum},(e=>{"error"==e.data.status?y.z8.error(e?.data?.message):e.data.data.length>0&&(this.RSignDetail=e.data.data,this.CaculateStepSign())}),(e=>{y.z8.error(e.message)}))},DoSignApplicationForScrap(){N.Z.DoSignApplicationForScrap(this.frm,(e=>{"error"==e.data.status?E.T.alert(` <div style="color:red"> ${e?.data?.message} </div>`,this.$t("Thông báo"),{dangerouslyUseHTMLString:!0,showClose:!1}):(this.isShowSignDialog=!1,this.frm.scrapDocNum=e.data.data,(0,y.z8)({message:e.data.message,type:"success",dangerouslyUseHTMLString:!0,duration:3e3,onClose:()=>{this.$router.go()}}))}),(e=>{y.z8.error(e.message)}))},DoSign(){this.frm.isReject=!1,this.isShowSignDialog=!0},DoReject(){this.frm.isReject=!0,this.isShowSignDialog=!0},GetSignRoutingOfApplicationForScrap(){this.frm.signStationLs=[],N.Z.GetSignRoutingOfApplicationForScrap({FactoryZone:this.frm.FactoryZone},(e=>{"error"==e.data.status?y.z8.error(e?.data?.message):(this.isShowSelectFactoryZone=!1,this.frm.signStationLs=e.data?.data,this.CaculateStepSign())}),(e=>{y.z8.error(e.message)}))},DeleteTempMedicineExport(e,t){let i=this.frm.medicineExportLs.findIndex((i=>i.F_MEDICINE_ID===e&&i.F_MEDICINE_EXPIRED_DATE==t));-1!=i&&this.frm.medicineExportLs.splice(i,1)},CheckValidCurObj(){return this.curMedicineID?.trim()?this.curMedicineName?.trim()?this.curMedicineObjUnit?.trim()?void 0:(y.z8.error(this.$t("Không có thông tin quy cách")),!1):(y.z8.error(this.$t("Không có thông tin tên thuốc")),!1):(y.z8.error(this.$t("Vui lòng chọn số hiệu")),!1)},AddTempMedicineExport(){if(0==this.CheckValidCurObj())return;let e={F_MEDICINE_ID:this.curMedicineID,F_MEDICINE_NAME:this.curMedicineNameVi+"/"+this.curMedicineNameEn,F_MEDICINE_NAME_VI:this.curMedicineNameVi,F_MEDICINE_NAME_EN:this.curMedicineNameEn,F_MEDICINE_OBJ_UNIT:this.curMedicineObjUnitVi+"/"+this.curMedicineObjUnitEn,F_MEDICINE_OBJ_UNIT_VI:this.curMedicineObjUnitVi,F_MEDICINE_OBJ_UNIT_EN:this.curMedicineObjUnitEn,F_MEDICINE_EXPIRED_DATE:this.curExpiredDate,F_QTY_SCRAP:this.curQtyInStockNow,F_REQUEST_DATE:"",F_SYSDATE:""};if(this.frm.medicineExportLs.length>0){let t=this.frm.medicineExportLs.filter((t=>{if(t.F_MEDICINE_ID==e.F_MEDICINE_ID&&t.F_MEDICINE_EXPIRED_DATE==e.F_MEDICINE_EXPIRED_DATE)return!0}));if(t.length>0)return void y.z8.error(this.$t("Số hiệu và ngày hết hạn hiện tại đã được thêm, vui lòng nhập lại"))}e.F_QTY_SCRAP<=0?y.z8.error(this.$t("Số hiệu và ngày hết hạn này hiện tại đang không có số lượng dư trong kho hoặc không tồn tại trong kho")):(this.frm.medicineExportLs.push(JSON.parse(JSON.stringify(e))),this.ResetSomeCurInfor(),this.ResetcurMedinceId())},ResetSome(){this.frm.FactoryZone="",this.isShowSelectFactoryZone=!0,this.curMedicineID="",this.ResetSomeCurInfor()},ResetcurMedinceId(){this.curMedicineID=""},ResetSomeCurInfor(){this.curMedicineName="",this.curMedicineNameVi="",this.curMedicineNameEn="",this.curMedicineObjUnit="",this.curMedicineObjUnitVi="",this.curMedicineObjUnitEn="",this.curQtyInStockNow=0,this.curExpiredDate=""},NextFromSelectFactory(){this.frm.FactoryZone?N.Z.CheckCurAccIsRole({roleLS:"admin;bu"},(e=>{"error"==e.data.status?y.z8.error(e?.data?.message):this.CheckCurrFZBelongFZOfAcc()}),(e=>{y.z8.error(e.message)})):y.z8.error(this.$t("Vui lòng chọn nhà xưởng đầu tiên"))},CheckCurrFZBelongFZOfAcc(){N.Z.CheckCurrFZBelongFZOfAcc({FactoryZone:this.frm.FactoryZone},(e=>{"error"==e.data.status?y.z8.error(e?.data?.message):this.GetSignRoutingOfApplicationForScrap()}),(e=>{y.z8.error(e.message)}))},GetFactoryZone(){this.FactoryZoneLs=[],N.Z.GetFactoryZone((e=>{e.data.data&&e.data.data.forEach((e=>{this.FactoryZoneLs.push({label:e.F_DATA2,value:e.F_DATA2})}))}),(e=>{y.z8.error(e.message)}))},GetTotalInforOfAnApplicationForScrap(){N.Z.GetTotalInforOfAnApplicationForScrap({scrapDocNum:this.frm.scrapDocNum},(e=>{if("error"==e.data.status)y.z8.error(e?.data?.message);else if(null==e?.data?.data)y.z8.error(this.$t("Không có dữ liệu đơn trên hệ thống"));else{let t=e?.data?.data;this.frm.scrapDocNum=t.scrapDocNum,this.frm.FactoryZone=t.FactoryZone,this.frm.medicineExportLs=t.medicineExportLs,this.isFirstStationNow=t.isFirstStation,this.frm.signStationLs=t.signStationLs,this.CaculateStepSign()}}),(e=>{y.z8.error(e.message)}))}},mounted(){},created(){this.GetFactoryZone(),this.$route.query.scrapDocNum?(this.isShowSelectFactoryZone=!1,this.frm.scrapDocNum=this.$route.query.scrapDocNum?.trim(),this.GetHistorySignOfApplicationForScrap(),this.GetTotalInforOfAnApplicationForScrap()):(this.isFirstStationNow=!0,this.isShowSelectFactoryZone=!0)}},I=i(89);const b=(0,I.Z)(F,[["render",D],["__scopeId","data-v-565c8ee2"]]);var k=b}}]);