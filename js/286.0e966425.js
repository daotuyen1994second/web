"use strict";(self["webpackChunkmedicine"]=self["webpackChunkmedicine"]||[]).push([[286],{7286:function(e,l,t){t.r(l),t.d(l,{default:function(){return z}});var a=t(3396),n=t(7139);const o={style:{"text-align":"left"}},r={class:"Form chon file va khu vuc xuong, sau do nhan upload"},i={class:"el-upload__tip",style:{color:"red"}},u={class:"el-upload__tip",style:{color:"red"}},d={class:"el-upload__tip",style:{color:"red"}},s={class:"Form show du lieu upload"},h=(0,a._)("br",null,null,-1),c={style:{color:"red","font-size":"small"}},p=(0,a._)("br",null,null,-1),m=(0,a._)("br",null,null,-1),f=(0,a._)("br",null,null,-1);function g(e,l,t,g,w,_){const b=(0,a.up)("el-text"),y=(0,a.up)("el-divider"),F=(0,a.up)("el-option"),z=(0,a.up)("el-select"),M=(0,a.up)("el-form-item"),W=(0,a.up)("el-col"),$=(0,a.up)("el-row"),D=(0,a.up)("Folder"),C=(0,a.up)("el-icon"),v=(0,a.up)("el-button"),x=(0,a.up)("Upload"),U=(0,a.up)("el-popconfirm"),k=(0,a.up)("el-upload"),E=(0,a.up)("el-input"),S=(0,a.up)("el-table-column"),A=(0,a.up)("Delete"),I=(0,a.up)("Download"),L=(0,a.up)("el-table"),T=(0,a.up)("el-pagination"),Z=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("h3",o,[(0,a.Wm)(b,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.$t("Dữ liệu tải lên hàng tháng:")),1)])),_:1})]),(0,a.Wm)(y),(0,a._)("div",r,[(0,a.Wm)($,{gutter:24,justify:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{sm:20},{default:(0,a.w5)((()=>[(0,a.Wm)($,{gutter:24},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{md:10},{default:(0,a.w5)((()=>[(0,a.Wm)(M,{label:e.$t("Khu xưởng/Phòng y tế")},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{modelValue:w.formMain.factoryZonee,"onUpdate:modelValue":l[0]||(l[0]=e=>w.formMain.factoryZonee=e),placeholder:e.$t("Vui lòng chọn khu xưởng/Phòng y tế"),clearable:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(w.empFactoryLS,(e=>((0,a.wg)(),(0,a.j4)(F,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1})])),_:1}),(0,a.Wm)($,{gutter:24},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{lg:10},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{ref:"uploadRef",class:"upload-demo",limit:1,"on-change":_.handleChangeFile,"on-remove":_.handleRemoveFile,"auto-upload":!1},{trigger:(0,a.w5)((()=>[(0,a.Wm)(v,{type:"primary",size:"large",plain:"",style:{"margin-bottom":"10px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(D)])),_:1}),(0,a.Uk)("   "+(0,n.zw)(e.$t("Chọn file")),1)])),_:1})])),tip:(0,a.w5)((()=>[(0,a._)("div",i,(0,n.zw)(e.$t("File có định dạng .pdf nhỏ hơn 2mb")),1),(0,a._)("div",u,(0,n.zw)(e.$t("File tải lên là file của tháng:"))+(0,n.zw)(w.BeforeMonth),1),(0,a._)("div",d,(0,n.zw)(e.$t("Tải lên tối đa 5 file trên tháng:"))+(0,n.zw)(w.BeforeMonth),1)])),default:(0,a.w5)((()=>[(0,a.Uk)("   "),(0,a.Wm)(U,{"confirm-button-text":e.$t("Có"),"cancel-button-text":e.$t("Không"),icon:e.InfoFilled,"icon-color":"#626AEF",title:e.$t("Bạn có chắc chắn muốn thao tác?"),onConfirm:l[1]||(l[1]=e=>_.UploadFileMonthly())},{reference:(0,a.w5)((()=>[(0,a.Wm)(v,{style:{"margin-top":"-6px"},type:"warning",size:"large",plain:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x)])),_:1}),(0,a.Uk)("   "+(0,n.zw)(e.$t("Tải lên danh sách")),1)])),_:1})])),_:1},8,["confirm-button-text","cancel-button-text","icon","title"])])),_:1},8,["on-change","on-remove"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,a._)("div",s,[(0,a.Wm)($,{gutter:24,justify:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{md:6},{default:(0,a.w5)((()=>[h,(0,a.Wm)(E,{modelValue:w.search,"onUpdate:modelValue":l[2]||(l[2]=e=>w.search=e),placeholder:e.$t("Mã thẻ/Tên file/Tháng"),clearable:""},null,8,["modelValue","placeholder"]),(0,a._)("p",c,(0,n.zw)(e.$t("Tháng có định dạng yyyy/MM, ví dụ:2024/04")),1)])),_:1}),(0,a.Wm)(W,{md:3},{default:(0,a.w5)((()=>[p,(0,a.Wm)(v,{onClick:_.SearchData},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.$t("Tìm kiếm")),1)])),_:1},8,["onClick"])])),_:1})])),_:1}),m,(0,a.wy)(((0,a.wg)(),(0,a.j4)(L,{data:w.tableData,key:w.tableKey,"element-loading-text":e.$t("Đang tải"),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{type:"index",sortable:"",label:e.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,a.Wm)(S,{prop:"F_MONTH_YEAR",sortable:"",label:e.$t("Tháng")},null,8,["label"]),(0,a.Wm)(S,{prop:"F_EMPNO",sortable:"",label:e.$t("Mã thẻ")},null,8,["label"]),(0,a.Wm)(S,{prop:"F_EMPNAME",sortable:"",label:e.$t("Họ tên")},null,8,["label"]),(0,a.Wm)(S,{prop:"F_FACTORYZONE",sortable:"",label:e.$t("Khu vực xưởng/phòng y tế")},null,8,["label"]),(0,a.Wm)(S,{prop:"F_FILE_DESC",sortable:"",label:e.$t("Tên file")},null,8,["label"]),(0,a.Wm)(S,{prop:"F_FILE_ID",sortable:"",label:e.$t("File id")},null,8,["label"]),(0,a.Wm)(S,{prop:"F_CREATED_DATE",sortable:"",label:e.$t("Thời gian tải lên")},null,8,["label"]),(0,a.Wm)(S,{fixed:"right",label:e.$t("Hành động"),width:"200"},{default:(0,a.w5)((l=>[(0,a.Wm)(U,{"confirm-button-text":e.$t("Có"),"cancel-button-text":e.$t("Không"),icon:e.InfoFilled,"icon-color":"#626AEF",title:e.$t("Bạn có chắc chắn muốn thao tác?"),onConfirm:e=>_.DeleteFileId(l.row.F_FILE_ID,l.row.F_FILE_EX)},{reference:(0,a.w5)((()=>[(0,a.Wm)(v,{size:"small",type:"danger",plain:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(A)])),_:1}),(0,a.Uk)("   "+(0,n.zw)(e.$t("Xóa")),1)])),_:1})])),_:2},1032,["confirm-button-text","cancel-button-text","icon","title","onConfirm"]),(0,a.Wm)(v,{type:"success",size:"small",style:{"text-decoration":"none"},onClick:e=>_.DownloadUploadMonthlyFile(l.row.F_FILE_ID,l.row.F_FILE_EX),tag:"a",rel:"noopener noreferrer",plain:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(I)])),_:1}),(0,a.Uk)("   "+(0,n.zw)(e.$t("Tải xuống")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])])),_:1},8,["data","element-loading-text"])),[[Z,w.Loading]]),f,(0,a.Wm)(T,{onSizeChange:_.handleSizeChange,onCurrentChange:_.handleCurrentChange,"current-page":w.currentPage,"page-sizes":[10,20,30,40],"page-size":w.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:w.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])],64)}t(560);var w=t(7178),_=t(1822),b={name:"UploadFileMonthly",data(){return{formMain:{factoryZonee:"",fileUpload:null},BeforeMonth:"",empFactoryLS:[],Loading:!1,tableData:[],tableKey:0,search:"",currentPage:1,pageSize:10,total:0}},methods:{DeleteFileId(e,l){_.Z.DeleteFileId({fileId:e,filex:l},(e=>{"success"==e?.data?.status?(w.z8.success(e?.data?.message),this.GetAllMonthlyData()):w.z8.error(e?.data?.message)}),(e=>{w.z8.error(e.message)}))},DownloadUploadMonthlyFile(e,l){window.open(_.Z.DownloadUploadMonthlyFile(e,l),"_blank")},handleRemoveFile(e){console.log(e),this.formMain.fileUpload=null},handleChangeFile(e){this.formMain.fileUpload=e},UploadFileMonthly(){try{if(!this.formMain.fileUpload?.raw)return void w.z8.error(this.$t("Vui lòng chọn file trước tiên"));if(!this.formMain.factoryZonee)return void w.z8.error(this.$t("Vui lòng chọn khu xưởng/phòng y tế"));if("application/pdf"!=this.formMain.fileUpload.raw.type)return void w.z8.error(this.$t("Vui lòng chọn file pdf"));if(console.log(""),this.formMain.fileUpload.raw.size>2097152)return void w.z8.error(this.$t("Kích thước file phải nhỏ hơn 2 mb"));var e=new FormData;e.append("factoryZonee",this.formMain.factoryZonee),e.append("file",this.formMain.fileUpload.raw),_.Z.UploadFileMonthly(e,(e=>{e?.data&&("success"==e?.data?.status?(this.formMain.fileUpload=null,w.z8.success(e?.data?.message),this.GetAllMonthlyData()):w.z8.error(e?.data?.message))}),(e=>{w.z8.error(e.message)}))}catch(l){console.log(l)}finally{this.$refs.uploadRef?.clearFiles()}},GetBeforeMonthFromNow(){_.Z.GetBeforeMonthFromNow((e=>{"error"==e?.data?.status?w.z8.error(e?.data?.message):this.BeforeMonth=e?.data.data}),(e=>{w.z8.error(e.message)}))},GetAllMonthlyData(){this.tableData=[],this.Loading=!0,_.Z.GetAllMonthlyData({search:this.search,page:this.currentPage,pageSize:this.pageSize},(e=>{if(this.Loading=!1,"error"==e.data.status)w.z8.error(e?.data?.message);else{let l=e.data.data;this.tableData=l.items,this.total=l.totalCount,this.tableKey+=1}}),(e=>{this.Loading=!1,w.z8.error(e.message)}))},SearchData(){this.GetAllMonthlyData()},handleSizeChange(e){this.pageSize=e,this.GetAllMonthlyData()},handleCurrentChange(e){this.currentPage=e,this.GetAllMonthlyData()}},created(){this.$store.state.empInfor?.F_FACTORYZONE_LS.forEach((e=>{this.empFactoryLS.push({label:e,value:e})})),this.GetAllMonthlyData(),this.GetBeforeMonthFromNow()}},y=t(89);const F=(0,y.Z)(b,[["render",g]]);var z=F}}]);