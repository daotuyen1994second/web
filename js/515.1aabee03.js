"use strict";(self["webpackChunkmedicine"]=self["webpackChunkmedicine"]||[]).push([[515],{2515:function(t,e,l){l.r(e),l.d(e,{default:function(){return y}});var a=l(3396),i=l(7139);const n={class:"title"},r={class:"Form show dau don"},s={key:0,class:"Form hien thi danh sach thuoc xin bao phe"},o={style:{"text-align":"left"}},u={style:{color:"#66CDAA",cursor:"pointer","font-size":"small"}},m={key:1,class:"Form lưu trình ký"},c={style:{"text-align":"left"}},p={key:2,class:"Form lich su ky duyet"},d={style:{"text-align":"left"}},h={class:"Form thao tac ky duyet",style:{"margin-top":"40px"}},g={class:"Dialog"},S={class:"dialog-footer"};function f(t,e,l,f,_,w){const D=(0,a.up)("el-text"),b=(0,a.up)("el-divider"),W=(0,a.up)("el-input"),k=(0,a.up)("el-form-item"),y=(0,a.up)("el-col"),N=(0,a.up)("el-row"),C=(0,a.up)("el-table-column"),F=(0,a.up)("el-button"),$=(0,a.up)("Delete"),T=(0,a.up)("el-icon"),A=(0,a.up)("el-table"),I=(0,a.up)("el-step"),E=(0,a.up)("el-tooltip"),z=(0,a.up)("el-steps"),M=(0,a.up)("EditPen"),R=(0,a.up)("Failed"),v=(0,a.up)("el-radio"),U=(0,a.up)("el-radio-group"),L=(0,a.up)("el-form"),x=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("h3",n,[(0,a.Wm)(D,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Đơn xin xác nhận báo phế")),1)])),_:1}),(0,a.Uk)(" :")]),(0,a.Wm)(b),(0,a._)("div",r,[(0,a.Wm)(N,{gutter:24,justify:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{md:10},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{label:t.$t("Đầu đơn xin xác nhận báo phế"),rules:[{required:!1}]},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{modelValue:_.frm.CscrapDocNum,"onUpdate:modelValue":e[0]||(e[0]=t=>_.frm.CscrapDocNum=t),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,a.Wm)(y,{md:10},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{label:t.$t("Khu xưởng/Phòng y tế"),rules:[{required:!1}]},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{modelValue:_.frm.FactoryZone,"onUpdate:modelValue":e[1]||(e[1]=t=>_.frm.FactoryZone=t),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})]),null!=this.frm.scrapMedinceLs&&this.frm.scrapMedinceLs.length>0?((0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("h3",o,[(0,a.Wm)(D,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Chi tiết các sản phẩm xin báo phế:")),1)])),_:1})]),(0,a.Wm)(b),(0,a.Wm)(A,{data:this.frm.scrapMedinceLs,style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{type:"index",label:t.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,a.Wm)(C,{prop:"F_MEDICINE_ID",label:t.$t("Số hiệu")},null,8,["label"]),(0,a.Wm)(C,{prop:"F_MEDICINE_NAME",label:t.$t("Tên hàng")},null,8,["label"]),(0,a.Wm)(C,{prop:"F_MEDICINE_OBJ_UNIT",label:t.$t("Quy cách")},null,8,["label"]),(0,a.Wm)(C,{prop:"F_MEDICINE_EXPIRED_DATE",label:t.$t("Hạn sử dụng")},null,8,["label"]),(0,a.Wm)(C,{prop:"F_QTY_SCRAP",label:t.$t("Số lượng báo phế")},null,8,["label"]),(0,a.Wm)(C,{prop:"F_REQUEST_DATE",label:t.$t("Ngày yêu cầu")},null,8,["label"]),(0,a.Wm)(C,{label:t.$t("Ngày xuất kho báo phế thực tế")},{default:(0,a.w5)((t=>[(0,a.Uk)((0,i.zw)(t.row.F_REQUEST_DATE==t.row.F_SYSDATE?"":t.row.F_SYSDATE),1)])),_:1},8,["label"]),(0,a.Wm)(C,{label:t.$t("Mã đầu đơn xin báo phế")},{default:(0,a.w5)((t=>[(0,a.Wm)(F,{size:"small",link:!0,onClick:e=>w.GotoDetailDocNumPage(t.row.F_SCRAP_DOC_NUM)},{default:(0,a.w5)((()=>[(0,a._)("span",u,(0,i.zw)(t.row.F_SCRAP_DOC_NUM),1)])),_:2},1032,["onClick"])])),_:1},8,["label"]),_.isFirstStationNow?((0,a.wg)(),(0,a.j4)(C,{key:0,label:t.$t("Hành động")},{default:(0,a.w5)((e=>[(0,a.Wm)(F,{size:"small",type:"danger",plain:"",onClick:t=>w.DeleteTempMedicineScrap(e.row.F_ROW_ID)},{default:(0,a.w5)((()=>[(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a.Wm)($)])),_:1}),(0,a.Uk)("   "+(0,i.zw)(t.$t("Xóa")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])):(0,a.kq)("",!0)])),_:1},8,["data"])])):(0,a.kq)("",!0),null!=this.frm.signStationLs&&this.frm.signStationLs.length>0?((0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("h3",c,[(0,a.Wm)(D,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Lưu trình ký:")),1)])),_:1})]),(0,a.Wm)(b),(0,a.Wm)(z,{style:{"max-width":"100%","margin-top":"30px"},active:_.activeStepSign,"finish-status":"success","align-center":""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.frm.signStationLs,(t=>((0,a.wg)(),(0,a.j4)(E,{key:t,class:"box-item",content:t.F_SIGN_STATION+"/"+t.F_SIGN_NAME+"/"+t.F_SIGN_EMP,placement:"top-start"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{title:t.F_SIGN_STATION,description:t.F_SIGN_NAME},null,8,["title","description"])])),_:2},1032,["content"])))),128))])),_:1},8,["active"])])):(0,a.kq)("",!0),null!=this.RSignDetail&&this.RSignDetail.length>0?((0,a.wg)(),(0,a.iD)("div",p,[(0,a._)("h3",d,[(0,a.Wm)(D,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Lịch sử ký duyệt:")),1)])),_:1})]),(0,a.Wm)(b),(0,a.Wm)(A,{data:this.RSignDetail,style:{width:"100%",height:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{type:"index",label:t.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,a.Wm)(C,{prop:"STATION_NAME",label:t.$t("Tên Trạm ký")},null,8,["label"]),(0,a.Wm)(C,{prop:"SIGN_STATUS",label:t.$t("Trạng thái")},null,8,["label"]),(0,a.Wm)(C,{prop:"SIGN_EMP",label:t.$t("Mã thẻ người ký")},null,8,["label"]),(0,a.Wm)(C,{prop:"SIGN_NAME",label:t.$t("Họ tên người ký")},null,8,["label"]),(0,a.Wm)(C,{prop:"SIGN_MAIL",label:t.$t("Email người ký")},null,8,["label"]),(0,a.Wm)(C,{prop:"SIGN_NOTES",label:t.$t("Ý kiến")},null,8,["label"]),(0,a.Wm)(C,{prop:"CREATE_DATE",label:t.$t("Ngày ký")},null,8,["label"])])),_:1},8,["data"])])):(0,a.kq)("",!0),(0,a._)("div",h,[(0,a.Wm)(N,{gutter:24},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{md:10}),(0,a.Wm)(y,{md:8},{default:(0,a.w5)((()=>[(0,a.Wm)(F,{size:"large",type:"success",onClick:e[2]||(e[2]=t=>w.DoSign()),plain:""},{default:(0,a.w5)((()=>[(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a.Wm)(M)])),_:1}),(0,a.Uk)("  "+(0,i.zw)(t.$t("Ký duyệt")),1)])),_:1}),(0,a.Uk)("   "),(0,a.Wm)(F,{size:"large",type:"danger",onClick:e[3]||(e[3]=t=>w.DoReject()),plain:""},{default:(0,a.w5)((()=>[(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a.Wm)(R)])),_:1}),(0,a.Uk)("  "+(0,i.zw)(t.$t("Từ chối")),1)])),_:1})])),_:1}),(0,a.Wm)(y,{md:10})])),_:1})]),(0,a._)("div",g,[(0,a.Wm)(x,{class:"Form xác nhận ký duyệt",modelValue:_.isShowSignDialog,"onUpdate:modelValue":e[8]||(e[8]=t=>_.isShowSignDialog=t),title:t.$t("Xác nhận ")+" "+(1==_.frm.isReject?t.$t("Từ chối"):t.$t("Ký duyệt")),width:"500"},{footer:(0,a.w5)((()=>[(0,a._)("div",S,[(0,a.Wm)(F,{plain:"",type:"primary",onClick:e[6]||(e[6]=t=>w.DoSignApplicationForCScrap())},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Gửi đi")),1)])),_:1}),(0,a.Wm)(F,{plain:"",type:"warning",onClick:e[7]||(e[7]=t=>_.isShowSignDialog=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Hủy bỏ")),1)])),_:1})])])),default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[(0,a.Wm)(k,{label:t.$t("Ý kiến")},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{modelValue:_.frm.remark,"onUpdate:modelValue":e[4]||(e[4]=t=>_.frm.remark=t),placeholder:t.$t("Nhập vào ý kiến của bạn"),type:"textarea"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),_.frm.isReject?((0,a.wg)(),(0,a.j4)(k,{key:0,label:t.$t("Trả về trạm:")},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{modelValue:_.frm.RejectStation,"onUpdate:modelValue":e[5]||(e[5]=t=>_.frm.RejectStation=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{label:"FirstStation"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Người làm đơn")),1)])),_:1}),(0,a.Wm)(v,{label:"BeforeStation"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("Trạm ký trước")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"])):(0,a.kq)("",!0)])),_:1})])),_:1},8,["modelValue","title"])])],64)}l(560);var _=l(6e3),w=l(7178),D=l(1822),b={name:"AppForScrapView",data(){return{frm:{CscrapDocNum:"",scrapDocNum:"",scrapMedinceLs:[],signStationLs:[],FactoryZone:"",remark:"",RejectStation:"BeforeStation",isReject:!1},activeStepSign:0,RSignDetail:[],isFirstStationNow:!1,isShowSignDialog:!1}},methods:{CaculateStepSign(){if(this.activeStepSign=0,null!=this.RSignDetail&&this.RSignDetail.length>0){let t=this.RSignDetail.filter((t=>{if("FinalPoint"==t.F_ROW_ID)return!0}));if(t.length>0){for(let e=0;e<this.frm.signStationLs.length;e++)if(this.frm.signStationLs[e].F_SIGN_STATION==t[0].STATION_NAME)return void(this.activeStepSign=e)}else this.activeStepSign=this.frm.signStationLs.length}else null!=this.frm.signStationLs&&this.frm.signStationLs.length>0&&this.frm.signStationLs.length>=2&&(this.activeStepSign=0)},GotoDetailDocNumPage(t){this.$router.push({path:"/NewApplicationForScrap",hash:"",query:{scrapDocNum:t}})},DeleteTempMedicineScrap(t){if(this.frm.scrapMedinceLs.length<=1)return void w.z8.error(this.$t("Danh sách vật phẩm xin báo phế chỉ gồm 1 sản phẩm, không thể xóa"));let e=this.frm.scrapMedinceLs.findIndex((e=>e.F_ROW_ID===t));-1!=e&&this.frm.scrapMedinceLs.splice(e,1)},DoSignApplicationForCScrap(){D.Z.DoSignApplicationForCScrap(this.frm,(t=>{"error"==t.data.status?_.T.alert(` <div style="color:red"> ${t?.data?.message} </div>`,this.$t("Thông báo"),{dangerouslyUseHTMLString:!0,showClose:!1}):(this.isShowSignDialog=!1,this.frm.CscrapDocNum=t.data.data,(0,w.z8)({message:t.data.message,type:"success",dangerouslyUseHTMLString:!0,duration:3e3,onClose:()=>{this.$router.go()}}))}),(t=>{w.z8.error(t.message)}))},DoSign(){this.frm.isReject=!1,this.isShowSignDialog=!0},DoReject(){this.frm.isReject=!0,this.isShowSignDialog=!0},GetTotalInforOfAnApplicationForCScrap(){D.Z.GetTotalInforOfAnApplicationForCScrap({CscrapDocNum:this.frm.CscrapDocNum},(t=>{if("error"==t.data.status)w.z8.error(t?.data?.message);else if(null==t?.data?.data)w.z8.error(this.$t("Không có dữ liệu đơn trên hệ thống"));else{let e=t?.data?.data;this.frm.CscrapDocNum=e.CscrapDocNum,this.frm.FactoryZone=e.FactoryZone,this.frm.scrapMedinceLs=e.scrapMedinceLs,this.isFirstStationNow=e.isFirstStation,this.frm.signStationLs=e.signStationLs,this.CaculateStepSign()}}),(t=>{w.z8.error(t.message)}))},GetHistorySignOfApplicationForCScrap(){this.RSignDetail=[],D.Z.GetHistorySignOfApplicationForCScrap({CscrapDocNum:this.frm.CscrapDocNum},(t=>{"error"==t.data.status?w.z8.error(t?.data?.message):t.data.data.length>0&&(this.RSignDetail=t.data.data,this.CaculateStepSign())}),(t=>{w.z8.error(t.message)}))}},created(){this.$route.query.CscrapDocNum&&(this.frm.CscrapDocNum=this.$route.query.CscrapDocNum?.trim(),this.GetHistorySignOfApplicationForCScrap(),this.GetTotalInforOfAnApplicationForCScrap())}},W=l(89);const k=(0,W.Z)(b,[["render",f],["__scopeId","data-v-5bb0c9a0"]]);var y=k}}]);