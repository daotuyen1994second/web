"use strict";(self["webpackChunkmedicine"]=self["webpackChunkmedicine"]||[]).push([[717],{7717:function(e,t,i){i.r(t),i.d(t,{default:function(){return $}});var l=i(3396),a=i(7139);const n=e=>((0,l.dD)("data-v-1d7e6b49"),e=e(),(0,l.Cn)(),e),r={key:0,class:"Form chọn khu xưởng"},s={key:1,class:"Form thao tac don xin cap phat"},o={key:0,style:{"text-align":"left"}},u={class:"title"},c={class:"Form thao tác nhập mã hiệu thuốc và add tạm thời"},m={key:1,class:"Form hien thi thong tin thuoc sau khi nhan nut Add"},d={style:{"text-align":"left"}},h={class:"Form show ghi chu sau khi nguoi lam don da nhan thuoc"},p={style:{"text-align":"left"}},g=n((()=>(0,l._)("br",null,null,-1))),f={key:0},_={key:2,class:"Form chọn lưu trình ký"},w={style:{"text-align":"left"}},S={key:3,class:"Form lich su ky duyet"},y={style:{"text-align":"left"}},N={class:"Form thao tac ky duyet",style:{"margin-top":"40px"}},I={class:"Dialog"},F={class:"dialog-footer"};function E(e,t,i,n,E,W){const k=(0,l.up)("el-option"),b=(0,l.up)("el-select"),D=(0,l.up)("el-form-item"),M=(0,l.up)("el-col"),v=(0,l.up)("el-row"),$=(0,l.up)("Right"),U=(0,l.up)("el-icon"),R=(0,l.up)("el-button"),V=(0,l.up)("Back"),C=(0,l.up)("Printer"),A=(0,l.up)("el-text"),z=(0,l.up)("el-divider"),T=(0,l.up)("el-input"),x=(0,l.up)("el-input-number"),O=(0,l.up)("Plus"),j=(0,l.up)("el-table-column"),Z=(0,l.up)("Delete"),L=(0,l.up)("el-table"),q=(0,l.up)("EditPen"),G=(0,l.up)("el-step"),Q=(0,l.up)("el-tooltip"),P=(0,l.up)("el-steps"),H=(0,l.up)("Failed"),B=(0,l.up)("el-radio"),K=(0,l.up)("el-radio-group"),Y=(0,l.up)("el-form"),J=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[E.isShowSelectFactoryZone?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(v,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Khu xưởng/Phòng y tế")},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{modelValue:E.frm.FactoryZone,"onUpdate:modelValue":t[0]||(t[0]=e=>E.frm.FactoryZone=e),placeholder:e.$t("Vui lòng chọn khu xưởng/Phòng y tế"),clearable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(E.FactoryZoneLs,(e=>((0,l.wg)(),(0,l.j4)(k,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.Wm)(v,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:8},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{size:"large",type:"success",onClick:t[1]||(t[1]=e=>W.NextFromSelectFactory()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)($)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Tiếp theo")),1)])),_:1})])),_:1})])),_:1})])):((0,l.wg)(),(0,l.iD)("div",s,[this.frm.receiveDocNum?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(R,{style:{border:"none"},onClick:t[2]||(t[2]=e=>W.ResetSome())},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(V)])),_:1}),(0,l.Uk)("   "+(0,a.zw)(e.$t("Trở lại")),1)])),_:1})])),(0,l._)("div",null,[(0,l.Wm)(R,{style:{float:"right"},onClick:t[3]||(t[3]=e=>W.Print())},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C)])),_:1}),(0,l.Uk)("   "+(0,a.zw)(e.$t("")),1)])),_:1})]),(0,l._)("h3",u,[(0,l.Wm)(A,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Đơn xin cấp phát")),1)])),_:1}),(0,l.Uk)(" :")]),(0,l.Wm)(z),(0,l._)("div",c,[(0,l.Wm)(v,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Đầu đơn xin cấp phát"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.frm.receiveDocNum,"onUpdate:modelValue":t[4]||(t[4]=e=>E.frm.receiveDocNum=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Đơn vị xin cấp phát"),rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.frm.receiveUnit,"onUpdate:modelValue":t[5]||(t[5]=e=>E.frm.receiveUnit=e),clearable:"",readonly:!!this.frm.receiveDocNum},null,8,["modelValue","readonly"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(M,{md:10},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Khu xưởng/Phòng y tế"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.frm.FactoryZone,"onUpdate:modelValue":t[6]||(t[6]=e=>E.frm.FactoryZone=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(v,{key:0,gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Số hiệu"),rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.curMedicineID,"onUpdate:modelValue":t[7]||(t[7]=e=>E.curMedicineID=e),clearable:"",onChange:t[8]||(t[8]=e=>W.ChangeMedicineId())},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Tên hàng"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.curMedicineName,"onUpdate:modelValue":t[9]||(t[9]=e=>E.curMedicineName=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Quy cách"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.curMedicineObjUnit,"onUpdate:modelValue":t[10]||(t[10]=e=>E.curMedicineObjUnit=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})):(0,l.kq)("",!0),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(v,{key:1,gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Số lượng tồn"),rules:[{required:!1}]},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.curQtyInStockNow,"onUpdate:modelValue":t[11]||(t[11]=e=>E.curQtyInStockNow=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.Wm)(M,{md:6},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Số lượng xin cấp"),rules:[{required:!0}]},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{modelValue:E.curQtyRequest,"onUpdate:modelValue":t[12]||(t[12]=e=>E.curQtyRequest=e),placeholder:e.$t("Nhập vào số lượng"),clearable:"",min:1,max:1e9,precision:0,"value-on-clear":"min"},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1})])),_:1})):(0,l.kq)("",!0),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(v,{key:2,gutter:24},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:11}),(0,l.Wm)(M,{md:2},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{size:"large",type:"success",onClick:t[13]||(t[13]=e=>W.AddTempMedicineExport()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(O)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Thêm")),1)])),_:1})])),_:1}),(0,l.Wm)(M,{md:11})])),_:1})):(0,l.kq)("",!0)]),null!=this.frm.medicineExportLs&&this.frm.medicineExportLs.length>0?((0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("h3",d,[(0,l.Wm)(A,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Chi tiết các sản phẩm xin:")),1)])),_:1})]),(0,l.Wm)(z),(0,l.Wm)(L,{data:this.frm.medicineExportLs,style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{type:"index",label:e.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,l.Wm)(j,{prop:"F_MEDICINE_ID",label:e.$t("Số hiệu")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_MEDICINE_NAME",label:e.$t("Tên hàng")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_MEDICINE_OBJ_UNIT",label:e.$t("Quy cách")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_QTY_REQUEST",label:e.$t("Số lượng xin cấp")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_REQUEST_DATE",label:e.$t("Ngày xin cấp")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_QTY_RECEIVED",label:e.$t("Số lượng xuất")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_RECEIVED_DATE",label:e.$t("Ngày nhận")},null,8,["label"]),(0,l.Wm)(j,{prop:"F_RECEIVED_EMP",label:e.$t("Người nhận")},null,8,["label"]),E.isFirstStationNow?((0,l.wg)(),(0,l.j4)(j,{key:0,label:e.$t("Hành động")},{default:(0,l.w5)((t=>[(0,l.Wm)(R,{size:"small",type:"danger",plain:"",onClick:e=>W.DeleteTempMedicineExport(t.row.F_MEDICINE_ID)},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Z)])),_:1}),(0,l.Uk)("   "+(0,a.zw)(e.$t("Xóa")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])):(0,l.kq)("",!0)])),_:1},8,["data"])])):(0,l.kq)("",!0),(0,l._)("div",h,[(0,l._)("h3",p,[(0,l.Wm)(A,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Người làm đơn ghi chú xác nhận đã nhận sản phẩm:")),1)])),_:1})]),(0,l.Wm)(z),(0,l.Wm)(v,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:10,style:{"text-align":"left","white-space":"pre-wrap"}},{default:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(this.frm.Remark),1)])),_:1})])),_:1})])),_:1}),g,E.isAllowRemark?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(v,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:10},{default:(0,l.w5)((()=>[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.curRemark,"onUpdate:modelValue":t[14]||(t[14]=e=>E.curRemark=e),placeholder:e.$t("Nhập vào ghi chú xác nhận bạn đã nhận sản phẩm"),type:"textarea"},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(v,{gutter:24,justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:10},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{size:"large",type:"success",onClick:t[15]||(t[15]=e=>W.SaveNoteReceivedGoodsOfAppForIssuance()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(q)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Lưu ghi chú")),1)])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)]),null!=this.frm.signStationLs&&this.frm.signStationLs.length>0?((0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("h3",w,[(0,l.Wm)(A,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Lưu trình ký:")),1)])),_:1})]),(0,l.Wm)(z),(0,l.Wm)(P,{style:{"max-width":"100%","margin-top":"30px"},active:E.activeStepSign,"finish-status":"success","align-center":""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(this.frm.signStationLs,(e=>((0,l.wg)(),(0,l.j4)(Q,{key:e,class:"box-item",content:e.F_SIGN_STATION+"/"+e.F_SIGN_NAME+"/"+e.F_SIGN_EMP,placement:"top-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{title:e.F_SIGN_STATION,description:e.F_SIGN_NAME},null,8,["title","description"])])),_:2},1032,["content"])))),128))])),_:1},8,["active"])])):(0,l.kq)("",!0),null!=this.RSignDetail&&this.RSignDetail.length>0?((0,l.wg)(),(0,l.iD)("div",S,[(0,l._)("h3",y,[(0,l.Wm)(A,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Lịch sử ký duyệt:")),1)])),_:1})]),(0,l.Wm)(z),(0,l.Wm)(L,{data:this.RSignDetail,style:{width:"100%",height:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{type:"index",label:e.$t("Số thứ tự"),width:"100"},null,8,["label"]),(0,l.Wm)(j,{prop:"STATION_NAME",label:e.$t("Tên Trạm ký")},null,8,["label"]),(0,l.Wm)(j,{prop:"SIGN_STATUS",label:e.$t("Trạng thái")},null,8,["label"]),(0,l.Wm)(j,{prop:"SIGN_EMP",label:e.$t("Mã thẻ người ký")},null,8,["label"]),(0,l.Wm)(j,{prop:"SIGN_NAME",label:e.$t("Họ tên người ký")},null,8,["label"]),(0,l.Wm)(j,{prop:"SIGN_MAIL",label:e.$t("Email người ký")},null,8,["label"]),(0,l.Wm)(j,{prop:"SIGN_NOTES",label:e.$t("Ý kiến")},null,8,["label"]),(0,l.Wm)(j,{prop:"CREATE_DATE",label:e.$t("Ngày ký")},null,8,["label"])])),_:1},8,["data"])])):(0,l.kq)("",!0),(0,l._)("div",N,[(0,l.Wm)(v,{gutter:24},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{md:10}),(0,l.Wm)(M,{md:8},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{size:"large",type:"success",onClick:t[16]||(t[16]=e=>W.DoSign()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(q)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Ký duyệt")),1)])),_:1}),(0,l.Uk)("   "),(0,l.Wm)(R,{size:"large",type:"danger",onClick:t[17]||(t[17]=e=>W.DoReject()),plain:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(H)])),_:1}),(0,l.Uk)("  "+(0,a.zw)(e.$t("Từ chối")),1)])),_:1})])),_:1}),(0,l.Wm)(M,{md:10})])),_:1})])])),(0,l._)("div",I,[(0,l.Wm)(J,{class:"Form xác nhận ký duyệt",modelValue:E.isShowSignDialog,"onUpdate:modelValue":t[22]||(t[22]=e=>E.isShowSignDialog=e),title:e.$t("Xác nhận ")+" "+(1==E.frm.isReject?e.$t("Từ chối"):e.$t("Ký duyệt")),width:"500"},{footer:(0,l.w5)((()=>[(0,l._)("div",F,[(0,l.Wm)(R,{plain:"",type:"primary",onClick:t[20]||(t[20]=e=>W.DoSignApplicationForIssuance())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Gửi đi")),1)])),_:1}),(0,l.Wm)(R,{plain:"",type:"warning",onClick:t[21]||(t[21]=e=>E.isShowSignDialog=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Hủy bỏ")),1)])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:e.$t("Ý kiến")},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{modelValue:E.frm.remark1,"onUpdate:modelValue":t[18]||(t[18]=e=>E.frm.remark1=e),placeholder:e.$t("Nhập vào ý kiến của bạn"),type:"textarea"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),E.frm.isReject?((0,l.wg)(),(0,l.j4)(D,{key:0,label:e.$t("Trả về trạm:")},{default:(0,l.w5)((()=>[(0,l.Wm)(K,{modelValue:E.frm.RejectStation,"onUpdate:modelValue":t[19]||(t[19]=e=>E.frm.RejectStation=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(B,{label:"FirstStation"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Người làm đơn")),1)])),_:1}),(0,l.Wm)(B,{label:"BeforeStation"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("Trạm ký trước")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["modelValue","title"])])],64)}i(560);var W=i(6e3),k=i(7178),b=i(1822),D={name:"NewApplicationForIssuance",data(){return{activeStepSign:0,isFirstStationNow:!1,isShowSignDialog:!1,FactoryZoneLs:[],isShowSelectFactoryZone:!0,isAllowRemark:!1,RSignDetail:[],frm:{receiveDocNum:"",medicineExportLs:[],receiveUnit:"",FactoryZone:"",signStationLs:[],remark1:"",RejectStation:"BeforeStation",isReject:!1,Remark:""},curMedicineID:"",curMedicineName:"",curMedicineNameVi:"",curMedicineNameEn:"",curMedicineObjUnit:"",curMedicineObjUnitVi:"",curMedicineObjUnitEn:"",curQtyInStockNow:0,curQtyRequest:0,curRemark:""}},methods:{Print(){const e=this.$router.resolve({name:"PrintAppForIssuance",hash:"",query:{receiveDocNum:this.frm.receiveDocNum}});window.open(e.href,"",`height=${window.innerHeight},width=${window.innerWidth}`)},SaveNoteReceivedGoodsOfAppForIssuance(){this.curRemark?.trim()?b.Z.SaveNoteReceivedGoodsOfAppForIssuance({receiveDocNum:this.frm.receiveDocNum,Remark:this.curRemark?.trim()},(e=>{"error"==e.data.status?k.z8.error(e?.data?.message):((0,k.z8)({message:e.data.message,type:"success"}),this.$router.go())}),(e=>{k.z8.error(e.message)})):k.z8.error(this.$t("Vui lòng nhập vào ghi chú xác nhận bạn đã nhận sản phẩm"))},GetHistorySignOfApplicationForIssuance(){this.RSignDetail=[],b.Z.GetHistorySignOfApplicationForIssuance({receiveDocNum:this.frm.receiveDocNum},(e=>{"error"==e.data.status?k.z8.error(e?.data?.message):e.data.data.length>0&&(this.RSignDetail=e.data.data,this.CaculateStepSign())}),(e=>{k.z8.error(e.message)}))},DoSignApplicationForIssuance(){b.Z.DoSignApplicationForIssuance(this.frm,(e=>{"error"==e.data.status?W.T.alert(` <div style="color:red"> ${e?.data?.message} </div>`,this.$t("Thông báo"),{dangerouslyUseHTMLString:!0,showClose:!1}):(this.isShowSignDialog=!1,this.frm.receiveDocNum=e.data.data,(0,k.z8)({message:e.data.message,type:"success",dangerouslyUseHTMLString:!0,duration:3e3,onClose:()=>{this.$router.go()}}))}),(e=>{k.z8.error(e.message)}))},DoSign(){this.frm.isReject=!1,this.isShowSignDialog=!0},DoReject(){this.frm.isReject=!0,this.isShowSignDialog=!0},GetSignRoutingOfApplicationForIssuance(){this.frm.signStationLs=[],b.Z.GetSignRoutingOfApplicationForIssuance({FactoryZone:this.frm.FactoryZone},(e=>{"error"==e.data.status?k.z8.error(e?.data?.message):(this.isShowSelectFactoryZone=!1,this.frm.signStationLs=e.data?.data,this.CaculateStepSign())}),(e=>{k.z8.error(e.message)}))},DeleteTempMedicineExport(e){let t=this.frm.medicineExportLs.findIndex((t=>t.F_MEDICINE_ID===e));-1!=t&&this.frm.medicineExportLs.splice(t,1)},CheckValidCurObj(){return this.curMedicineID?.trim()?this.frm.receiveUnit?.trim()?this.curMedicineName?.trim()?this.curMedicineObjUnit?.trim()?this.curQtyRequest<=0?(k.z8.error(this.$t("Số lượng xin cấp phát phải >0")),!1):void 0:(k.z8.error(this.$t("Không có thông tin quy cách")),!1):(k.z8.error(this.$t("Không có thông tin tên thuốc")),!1):(k.z8.error(this.$t("Vui lòng nhập vào tên đơn vị xin cấp phát")),!1):(k.z8.error(this.$t("Vui lòng chọn số hiệu")),!1)},AddTempMedicineExport(){if(0==this.CheckValidCurObj())return;let e={F_MEDICINE_ID:this.curMedicineID,F_MEDICINE_NAME:this.curMedicineNameVi+"/"+this.curMedicineNameEn,F_MEDICINE_NAME_VI:this.curMedicineNameVi,F_MEDICINE_NAME_EN:this.curMedicineNameEn,F_MEDICINE_OBJ_UNIT:this.curMedicineObjUnitVi+"/"+this.curMedicineObjUnitEn,F_MEDICINE_OBJ_UNIT_VI:this.curMedicineObjUnitVi,F_MEDICINE_OBJ_UNIT_EN:this.curMedicineObjUnitEn,F_QTY_REQUEST:this.curQtyRequest,F_REQUEST_DATE:"",F_QTY_RECEIVED:0,F_RECEIVE_DOC_NUM:this.frm.receiveDocNum,F_FACTORYZONE:this.frm.FactoryZone,F_RECEIVED_DATE:"",F_RECEIVED_EMP:""};if(this.frm.medicineExportLs.length>0){let t=this.frm.medicineExportLs.filter((t=>{if(t.F_MEDICINE_ID==e.F_MEDICINE_ID)return!0}));if(t.length>0)return void k.z8.error(this.$t("Số hiệu này đã được thêm, vui lòng chọn số hiệu khác"))}this.frm.medicineExportLs.push(JSON.parse(JSON.stringify(e))),this.ResetSomeCurInfor(),this.ResetcurMedinceId()},ChangeMedicineId(){if(""==this.curMedicineID?.trim())return this.ResetSomeCurInfor(),void k.z8.error(this.$t("Vui lòng nhập vào số hiệu"));this.ResetSomeCurInfor(),b.Z.CheckMedicineIDForApplicationForIssuance({MedicineID:this.curMedicineID?.trim(),FactoryZone:this.frm.FactoryZone},(e=>{if("error"==e.data.status)k.z8.error(e?.data?.message);else if(e?.data?.data){let t=e?.data?.data;this.curMedicineNameVi=t.MedicineNameVi,this.curMedicineNameEn=t.MedicineNameEn,this.curMedicineName=this.curMedicineNameVi+"/"+this.curMedicineNameEn,this.curMedicineObjUnitVi=t.MedicineObjUnitVi,this.curMedicineObjUnitEn=t.MedicineObjUnitEn,this.curMedicineObjUnit=this.curMedicineObjUnitVi+"/"+this.curMedicineObjUnitEn,this.curQtyInStockNow=t.QtyInStockNow}}),(e=>{k.z8.error(e.message)}))},ResetSome(){this.frm.FactoryZone="",this.isShowSelectFactoryZone=!0,this.curMedicineID="",this.ResetSomeCurInfor()},ResetcurMedinceId(){this.curMedicineID=""},ResetSomeCurInfor(){this.curMedicineName="",this.curMedicineNameVi="",this.curMedicineNameEn="",this.curMedicineObjUnit="",this.curMedicineObjUnitVi="",this.curMedicineObjUnitEn="",this.curQtyInStockNow=0,this.curQtyRequest=0},NextFromSelectFactory(){this.frm.FactoryZone?b.Z.CheckCurAccIsRole({roleLS:"admin;bu"},(e=>{"error"==e.data.status?k.z8.error(e?.data?.message):this.CheckCurrFZBelongFZOfAcc()}),(e=>{k.z8.error(e.message)})):k.z8.error(this.$t("Vui lòng chọn nhà xưởng đầu tiên"))},CheckCurrFZBelongFZOfAcc(){b.Z.CheckCurrFZBelongFZOfAcc({FactoryZone:this.frm.FactoryZone},(e=>{"error"==e.data.status?k.z8.error(e?.data?.message):this.GetSignRoutingOfApplicationForIssuance()}),(e=>{k.z8.error(e.message)}))},GetFactoryZone(){this.FactoryZoneLs=[],b.Z.GetFactoryZone((e=>{e.data.data&&e.data.data.forEach((e=>{this.FactoryZoneLs.push({label:e.F_DATA2,value:e.F_DATA2})}))}),(e=>{k.z8.error(e.message)}))},GetTotalInforOfAnApplicationForIssuance(){b.Z.GetTotalInforOfAnApplicationForIssuance({receiveDocNum:this.frm.receiveDocNum},(e=>{if("error"==e.data.status)k.z8.error(e?.data?.message);else if(null==e?.data?.data)k.z8.error(this.$t("Không có dữ liệu đơn trên hệ thống"));else{let t=e?.data?.data;this.frm.receiveDocNum=t.receiveDocNum,this.frm.receiveUnit=t.receiveUnit,this.frm.FactoryZone=t.FactoryZone,this.frm.medicineExportLs=t.medicineExportLs,this.isFirstStationNow=t.isFirstStation,this.frm.signStationLs=t.signStationLs,this.frm.Remark=t.Remark,this.isAllowRemark=t.isAllowRemark,this.CaculateStepSign()}}),(e=>{k.z8.error(e.message)}))},CaculateStepSign(){if(this.activeStepSign=0,null!=this.RSignDetail&&this.RSignDetail.length>0){let e=this.RSignDetail.filter((e=>{if("FinalPoint"==e.F_ROW_ID)return!0}));if(e.length>0){for(let t=0;t<this.frm.signStationLs.length;t++)if(this.frm.signStationLs[t].F_SIGN_STATION==e[0].STATION_NAME)return void(this.activeStepSign=t)}else this.activeStepSign=this.frm.signStationLs.length}else null!=this.frm.signStationLs&&this.frm.signStationLs.length>0&&this.frm.signStationLs.length>=2&&(this.activeStepSign=0)}},mounted(){},created(){this.GetFactoryZone(),this.$route.query.receiveDocNum?(this.isShowSelectFactoryZone=!1,this.frm.receiveDocNum=this.$route.query.receiveDocNum?.trim(),this.GetHistorySignOfApplicationForIssuance(),this.GetTotalInforOfAnApplicationForIssuance()):(this.isFirstStationNow=!0,this.isShowSelectFactoryZone=!0)}},M=i(89);const v=(0,M.Z)(D,[["render",E],["__scopeId","data-v-1d7e6b49"]]);var $=v}}]);